<?xml version="1.0" encoding="UTF-8"?>
<Project>
    <PropertyGroup>
        <BuildDebug>true</BuildDebug>
    </PropertyGroup>

    <Target Name="Clean">
        <CleanProjectsConfig Debug="$(BuildDebug)" PackagesDir="$(PackagesDir)" ProjectDir="$(MSBuildProjectDirectory)">
        </CleanProjectsConfig>
    </Target>
    <Target Name="LoadLocalBuildConfig" BeforeTargets="_GetReferenceAssemblyPaths;_BeforeCoreCompileInterfaceDefinitions">
        <LoadLocalBuildConfig Debug="$(BuildDebug)" ProjectName="$(MSBuildProjectName)" BuildConfiguration="$(Configuration)" PackagesDir="$(PackagesDir)" ProjectDir="$(MSBuildProjectDirectory)">
            <Output TaskParameter="BuildResourceDir" PropertyName="BuildResourceDir" />
            <Output TaskParameter="PackagingOutput" ItemName="PackagingFields" />
            <Output TaskParameter="AppIconOutput" ItemName="AppIconFields" />
            <Output TaskParameter="SplashOutput" ItemName="SplashFields" />
            <Output TaskParameter="NeedsLoadRemote" PropertyName="NeedsLoadRemote" />
        </LoadLocalBuildConfig>
    </Target>
    <Target Name="LoadRemoteBuildConfig" AfterTargets="LoadLocalBuildConfig" Condition="'$(NeedsLoadRemote)' == 'True'">
        <LoadRemoteBuildConfig Debug="$(BuildDebug)" ProjectName="$(MSBuildProjectName)" BuildConfiguration="$(Configuration)" PackagesDir="$(PackagesDir)" ProjectDir="$(MSBuildProjectDirectory)">
            <Output TaskParameter="BuildResourceDir" PropertyName="BuildResourceDir" />
            <Output TaskParameter="PackagingOutput" ItemName="PackagingFields" />
            <Output TaskParameter="AppIconOutput" ItemName="AppIconFields" />
            <Output TaskParameter="SplashOutput" ItemName="SplashFields" />
        </LoadRemoteBuildConfig>
    </Target>
    <Target Name="DeleteUnusedMediaFiles" AfterTargets="LoadRemoteBuildConfig">
        <DeleteUnusedMediaFiles Debug="$(BuildDebug)" ProjectDir="$(MSBuildProjectDirectory)" PackagesDir="$(PackagesDir)" AppIconFields="@(AppIconFields)" SplashFields="@(SplashFields)" BuildConfiguration="$(Configuration)">
        </DeleteUnusedMediaFiles>
    </Target>
    <Target Name="DownloadMediaFiles" AfterTargets="DeleteUnusedMediaFiles">
        <DownloadMediaFiles Debug="$(BuildDebug)" ProjectDir="$(MSBuildProjectDirectory)" PackagesDir="$(PackagesDir)" AppIconFields="@(AppIconFields)" SplashFields="@(SplashFields)" BuildConfiguration="$(Configuration)">
        </DownloadMediaFiles>
    </Target>
    <Target Name="SetDroidManifest" AfterTargets="DownloadMediaFiles" Condition="'$(TargetFrameworkIdentifier)' == 'MonoAndroid'">
        <SetDroidManifest Debug="$(BuildDebug)" ProjectDir="$(MSBuildProjectDirectory)" PackagingFields="@(PackagingFields)" AndroidManifest="$(AndroidManifest)">
        </SetDroidManifest>
    </Target>
    <Target Name="SetDroidAppIcons" AfterTargets="SetDroidManifest" Condition="'$(TargetFrameworkIdentifier)' == 'MonoAndroid'">
        <SetDroidAppIcons Debug="$(BuildDebug)" BuildConfiguration="$(Configuration)" PackagesDir="$(PackagesDir)" ProjectDir="$(MSBuildProjectDirectory)" AppIconFields="@(AppIconFields)" >
            <Output TaskParameter="OutputFiles" ItemName="DroidAppIcons" />
        </SetDroidAppIcons>
        <ItemGroup>
            <AndroidResource Include="%(DroidAppIcons.Identity)">
                <LogicalName>%(DroidAppIcons.LogicalName)</LogicalName>
            </AndroidResource>
        </ItemGroup>
    </Target>
    <Target Name="SetIosAppIcons" AfterTargets="SetDroidManifest" Condition="'$(TargetFrameworkIdentifier)' == 'Xamarin.iOS'">
        <SetIosAppIcons Debug="$(BuildDebug)" BuildConfiguration="$(Configuration)" PackagesDir="$(PackagesDir)" ProjectDir="$(MSBuildProjectDirectory)" AppIconFields="@(AppIconFields)" >
            <Output TaskParameter="OutputFiles" ItemName="IosAppIcons" />
        </SetIosAppIcons>
       <ItemGroup>
            <ImageAsset Include="%(IosAppIcons.Identity)">
            </ImageAsset>

        </ItemGroup>
<!--                    <Warning Text="ImageAsset %(IosAppIcons.Identity)" />-->
<!--
                <LogicalName>%(IosAppIcons.LogicalName)</LogicalName>-->
    </Target>

    <Target Name="TestImageAssets" AfterTargets="_BeforeCoreCompileImageAssets" Condition="'$(TargetFrameworkIdentifier)' == 'Xamarin.iOS'">
    <TestImageAssets ImageAssets="@(ImageAsset)">
        </TestImageAssets>
    </Target>
</Project>